stages:
  master bias:
    cmd: python python/masterBias.py
    deps:
        - python/masterBias.py
        - python/pipeline.py
    params:
        - MasterBiasImage.inputPath
        - MasterBiasImage.outputPath
    outs:
        - ${MasterBiasImage.outputPath}
  master flat:
    cmd: python python/masterFlat.py
    deps:
        - Data/ProcessedData/MasterBias
        - python/masterFlat.py
        - python/pipeline.py
    params:
        - MasterFlatImage.inputPath
        - MasterFlatImage.outputPath
        - MasterBiasImage.outputPath
    outs:
        - ${MasterFlatImage.outputPath}
  master ThAr:
    cmd: python python/masterThAr.py
    deps:
        - Data/ProcessedData/masterThAr
        - python/masterThAr.py
    params:
        - MasterThArImage.inputPath
        - MasterThArImage.outputPath
        - MasterBiasImage.outputPath
    outs:
        - ${MasterThArImage.outputPath}
  bias subtraction:
    cmd: python python/biasCorrectedScienceImage.py
    deps:
        - Data/ProcessedData/MasterBias
    params:
        - BiasSubtractedScienceImage.inputPath
        - BiasSubtractedScienceImage.outputPath
        - MasterBiasImage.outputPath
  2D order mask determination:
    cmd: ./pipeline/target/release/2dmaskdetermination
    deps:
        - pipeline/src/bin/2dmaskdetermination.rs
        - Data/ProcessedData/MasterFlat
    params:
        - TwoDimensionalOrderMaskTracing.inputPath
        - TwoDimensionalOrderMaskTracing.outputPath
        - TwoDimensionalOrderMaskTracing.outputPathSmoothedMasterFlat
    outs:
        - ${TwoDimensionalOrderMaskTracing.outputPath}
        - ${TwoDimensionalOrderMaskTracing.outputPathSmoothedMasterFlat}
  1D flat-relative order extraction:
    cmd: ./pipeline/target/release/1dflatrelativeorderextraction
    deps:
        - pipeline/src/bin/1dflatrelativeorderextraction.rs
        - Data/ProcessedData/OrderMask 
    params:
        - TwoDimensionalOrderMaskTracing.outputPath
  Etalon peaks fitting:
    cmd: ./pipeline/target/release/fitetalonpeaks
    deps:
        - Data/ProcessedData/OptimalExtraction/ 
    params:
        - EtalonPeakFitting.inputPath
        - EtalonPeakFitting.outputPath
        - OptimalOrderExtraction.outputPath


