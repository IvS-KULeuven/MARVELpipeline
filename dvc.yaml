stages:
  master bias:
    cmd: python python/masterBias.py
    deps:
        - python/masterBias.py
        - python/pipeline.py
    params:
        - MasterBiasImage.inputPath
        - MasterBiasImage.outputPath
    outs:
        - ${MasterBiasImage.outputPath}
  master flat:
    cmd: python python/masterFlat.py
    deps:
        - Data/ProcessedData/MasterBias
        - python/masterFlat.py
        - python/pipeline.py
    params:
        - MasterFlatImage.inputPath
        - MasterFlatImage.outputPath
        - MasterBiasImage.outputPath
    outs:
        - ${MasterFlatImage.outputPath}
  master ThAr:
    cmd: python python/masterThAr.py
    deps:
        - Data/ProcessedData/masterThAr
        - python/masterThAr.py
    params:
        - MasterThArImage.inputPath
        - MasterThArImage.outputPath
        - MasterBiasImage.outputPath
    outs:
        - ${MasterThArImage.outputPath}
  bias subtraction:
    cmd: python python/biasCorrectedScienceImage.py
    deps:
        - Data/ProcessedData/MasterBias
    params:
        - BiasSubtractedScienceImage.inputPath
        - BiasSubtractedScienceImage.outputPath
        - MasterBiasImage.outputPath
  2D mask determination:
    cmd: ./pipeline/target/release/2dmaskdetermination
    deps:
        - Data/ProcessedData/MasterFlat
    params:
        - MasterFlatImage.outputPath
        - TwoDimensionalOrderExtraction.outputPathMask
    outs:
        - ${TwoDimensionalOrderExtraction.outputPathMask}
  2D order extraction:
    cmd: ./pipeline/target/release/2dorderextraction
    deps:
        - Data/ProcessedData/ExtractedOrders/Mask
        - Data/ProcessedData/BiasSubtractedScience
        - Data/ProcessedData/MasterThAr 
    params:
        - TwoDimensionalOrderExtraction.outputPathMask
        - BiasSubtractedScienceImage.outputPath
        - MasterThArImage.outputPath
  1D flat-relative order extraction:
    cmd: ./pipeline/target/release/1dflatrelativeorderextraction
    deps:
        - Data/ProcessedData/ExtractedOrders/Mask
    params:
        - TwoDimensionalOrderExtraction.outputPathMask
        - TwoDimensionalOrderExtraction.outputPathTwoDimensionalOrders
  Etalon peaks fitting:
    cmd: ./pipeline/target/release/fitetalonpeaks
    deps:
        - Data/ProcessedData/OptimalExtraction/ 
    params:
        -  EtalonPeakFitting.outputPath
